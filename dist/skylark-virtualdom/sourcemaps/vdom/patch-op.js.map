{"version":3,"sources":["vdom/patch-op.js"],"names":["define","__module__0","__module__1","__module__2","__module__3","exports","module","applyProperties","isWidget","VPatch","updateWidget","destroyWidget","domNode","w","destroy","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","vpatch","renderOptions","type","vNode","patch","REMOVE","parentNode","removeChild","removeNode","INSERT","newNode","render","appendChild","insertNode","VTEXT","leftVNode","vText","nodeType","replaceData","length","text","replaceChild","stringPatch","WIDGET","widget","updating","update","widgetPatch","VNODE","vNodePatch","ORDER","moves","node","remove","insert","childNodes","keyMap","i","removes","from","key","j","inserts","insertBefore","to","reorderChildren","PROPS","properties","THUNK","oldRoot","newRoot","replaceRoot"],"mappings":"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","file":"../../vdom/patch-op.js","sourcesContent":["define([\n    './apply-properties',\n    '../vnode/is-widget',\n    '../vnode/vpatch',\n    './update-widget'\n], function (__module__0, __module__1, __module__2, __module__3) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var applyProperties = __module__0;\n    var isWidget = __module__1;\n    var VPatch = __module__2;\n    var updateWidget = __module__3;\n    module.exports = applyPatch;\n    function applyPatch(vpatch, domNode, renderOptions) {\n        var type = vpatch.type;\n        var vNode = vpatch.vNode;\n        var patch = vpatch.patch;\n        switch (type) {\n        case VPatch.REMOVE:\n            return removeNode(domNode, vNode);\n        case VPatch.INSERT:\n            return insertNode(domNode, patch, renderOptions);\n        case VPatch.VTEXT:\n            return stringPatch(domNode, vNode, patch, renderOptions);\n        case VPatch.WIDGET:\n            return widgetPatch(domNode, vNode, patch, renderOptions);\n        case VPatch.VNODE:\n            return vNodePatch(domNode, vNode, patch, renderOptions);\n        case VPatch.ORDER:\n            reorderChildren(domNode, patch);\n            return domNode;\n        case VPatch.PROPS:\n            applyProperties(domNode, patch, vNode.properties);\n            return domNode;\n        case VPatch.THUNK:\n            return replaceRoot(domNode, renderOptions.patch(domNode, patch, renderOptions));\n        default:\n            return domNode;\n        }\n    }\n    function removeNode(domNode, vNode) {\n        var parentNode = domNode.parentNode;\n        if (parentNode) {\n            parentNode.removeChild(domNode);\n        }\n        destroyWidget(domNode, vNode);\n        return null;\n    }\n    function insertNode(parentNode, vNode, renderOptions) {\n        var newNode = renderOptions.render(vNode, renderOptions);\n        if (parentNode) {\n            parentNode.appendChild(newNode);\n        }\n        return parentNode;\n    }\n    function stringPatch(domNode, leftVNode, vText, renderOptions) {\n        var newNode;\n        if (domNode.nodeType === 3) {\n            domNode.replaceData(0, domNode.length, vText.text);\n            newNode = domNode;\n        } else {\n            var parentNode = domNode.parentNode;\n            newNode = renderOptions.render(vText, renderOptions);\n            if (parentNode && newNode !== domNode) {\n                parentNode.replaceChild(newNode, domNode);\n            }\n        }\n        return newNode;\n    }\n    function widgetPatch(domNode, leftVNode, widget, renderOptions) {\n        var updating = updateWidget(leftVNode, widget);\n        var newNode;\n        if (updating) {\n            newNode = widget.update(leftVNode, domNode) || domNode;\n        } else {\n            newNode = renderOptions.render(widget, renderOptions);\n        }\n        var parentNode = domNode.parentNode;\n        if (parentNode && newNode !== domNode) {\n            parentNode.replaceChild(newNode, domNode);\n        }\n        if (!updating) {\n            destroyWidget(domNode, leftVNode);\n        }\n        return newNode;\n    }\n    function vNodePatch(domNode, leftVNode, vNode, renderOptions) {\n        var parentNode = domNode.parentNode;\n        var newNode = renderOptions.render(vNode, renderOptions);\n        if (parentNode && newNode !== domNode) {\n            parentNode.replaceChild(newNode, domNode);\n        }\n        return newNode;\n    }\n    function destroyWidget(domNode, w) {\n        if (typeof w.destroy === 'function' && isWidget(w)) {\n            w.destroy(domNode);\n        }\n    }\n    function reorderChildren(domNode, moves) {\n        var childNodes = domNode.childNodes;\n        var keyMap = {};\n        var node;\n        var remove;\n        var insert;\n        for (var i = 0; i < moves.removes.length; i++) {\n            remove = moves.removes[i];\n            node = childNodes[remove.from];\n            if (remove.key) {\n                keyMap[remove.key] = node;\n            }\n            domNode.removeChild(node);\n        }\n        var length = childNodes.length;\n        for (var j = 0; j < moves.inserts.length; j++) {\n            insert = moves.inserts[j];\n            node = keyMap[insert.key];\n            domNode.insertBefore(node, insert.to >= length++ ? null : childNodes[insert.to]);\n        }\n    }\n    function replaceRoot(oldRoot, newRoot) {\n        if (oldRoot && newRoot && oldRoot !== newRoot && oldRoot.parentNode) {\n            oldRoot.parentNode.replaceChild(newRoot, oldRoot);\n        }\n        return newRoot;\n    }\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}